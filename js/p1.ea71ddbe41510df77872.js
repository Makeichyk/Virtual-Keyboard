(()=>{"use strict";const e={Backquote:{keyId:"Backquote",eng:{value:"`",alt:"~"},rus:{value:"ё",alt:"Ё"}},Digit1:{keyId:"Digit1",eng:{value:"1",alt:"!"},rus:{value:"1",alt:"!"}},Digit2:{keyId:"Digit2",eng:{value:"2",alt:"@"},rus:{value:"2",alt:'"'}},Digit3:{keyId:"Digit3",eng:{value:"3",alt:"#"},rus:{value:"3",alt:"№"}},Digit4:{keyId:"Digit4",eng:{value:"4",alt:"$"},rus:{value:"4",alt:";"}},Digit5:{keyId:"Digit5",eng:{value:"5",alt:"%"},rus:{value:"5",alt:"%"}},Digit6:{keyId:"Digit6",eng:{value:"6",alt:"^"},rus:{value:"6",alt:":"}},Digit7:{keyId:"Digit7",eng:{value:"7",alt:"&"},rus:{value:"7",alt:"?"}},Digit8:{keyId:"Digit8",eng:{value:"8",alt:"*"},rus:{value:"8",alt:"*"}},Digit9:{keyId:"Digit9",eng:{value:"9",alt:"("},rus:{value:"9",alt:"("}},Digit0:{keyId:"Digit0",eng:{value:"0",alt:")"},rus:{value:"0",alt:")"}},Minus:{keyId:"Minus",eng:{value:"-",alt:"_"},rus:{value:"-",alt:"_"}},Equal:{keyId:"Equal",eng:{value:"=",alt:"+"},rus:{value:"=",alt:"+"}},Backspace:{keyId:"Backspace",eng:{value:"Backspace",alt:"Backspace"},rus:{value:"Backspace",alt:"Backspace"}},Tab:{keyId:"Tab",eng:{value:"Tab",alt:"Tab"},rus:{value:"Tab",alt:"Tab"},specialSymbol:"\t"},KeyQ:{keyId:"KeyQ",eng:{value:"q",alt:"Q"},rus:{value:"й",alt:"Й"}},KeyW:{keyId:"KeyW",eng:{value:"w",alt:"W"},rus:{value:"ц",alt:"Ц"}},KeyE:{keyId:"KeyE",eng:{value:"e",alt:"E"},rus:{value:"у",alt:"У"}},KeyR:{keyId:"KeyR",eng:{value:"r",alt:"R"},rus:{value:"к",alt:"К"}},KeyT:{keyId:"KeyT",eng:{value:"t",alt:"T"},rus:{value:"е",alt:"Е"}},KeyY:{keyId:"KeyY",eng:{value:"y",alt:"Y"},rus:{value:"н",alt:"Н"}},KeyU:{keyId:"KeyU",eng:{value:"u",alt:"U"},rus:{value:"г",alt:"Г"}},KeyI:{keyId:"KeyI",eng:{value:"i",alt:"I"},rus:{value:"ш",alt:"Ш"}},KeyO:{keyId:"KeyO",eng:{value:"o",alt:"O"},rus:{value:"щ",alt:"Щ"}},KeyP:{keyId:"KeyP",eng:{value:"p",alt:"P"},rus:{value:"з",alt:"З"}},BracketLeft:{keyId:"BracketLeft",eng:{value:"[",alt:"{"},rus:{value:"х",alt:"Х"}},BracketRight:{keyId:"BracketRight",eng:{value:"]",alt:"}"},rus:{value:"ъ",alt:"Ъ"}},Backslash:{keyId:"Backslash",eng:{value:"\\",alt:"|"},rus:{value:"\\",alt:"/"}},Delete:{keyId:"Delete",eng:{value:"Del",alt:"Del"},rus:{value:"Del",alt:"Del"}},CapsLock:{keyId:"CapsLock",eng:{value:"Caps lock",alt:"Caps lock"},rus:{value:"Caps lock",alt:"Caps lock"}},KeyA:{keyId:"KeyA",eng:{value:"a",alt:"A"},rus:{value:"ф",alt:"Ф"}},KeyS:{keyId:"KeyS",eng:{value:"s",alt:"S"},rus:{value:"ы",alt:"Ы"}},KeyD:{keyId:"KeyD",eng:{value:"d",alt:"D"},rus:{value:"в",alt:"В"}},KeyF:{keyId:"KeyF",eng:{value:"f",alt:"F"},rus:{value:"а",alt:"А"}},KeyG:{keyId:"KeyG",eng:{value:"g",alt:"G"},rus:{value:"п",alt:"П"}},KeyH:{keyId:"KeyH",eng:{value:"h",alt:"H"},rus:{value:"р",alt:"Р"}},KeyJ:{keyId:"KeyJ",eng:{value:"j",alt:"J"},rus:{value:"о",alt:"О"}},KeyK:{keyId:"KeyK",eng:{value:"k",alt:"K"},rus:{value:"л",alt:"Л"}},KeyL:{keyId:"KeyL",eng:{value:"l",alt:"L"},rus:{value:"д",alt:"Д"}},Semicolon:{keyId:"Semicolon",eng:{value:";",alt:":"},rus:{value:"ж",alt:"Ж"}},Quote:{keyId:"Quote",eng:{value:"'",alt:'"'},rus:{value:"э",alt:"Э"}},Enter:{keyId:"Enter",eng:{value:"Enter",alt:"Enter"},rus:{value:"Enter",alt:"Enter"},specialSymbol:"\n"},ShiftLeft:{keyId:"ShiftLeft",eng:{value:"Shift",alt:"Shift"},rus:{value:"Shift",alt:"Shift"}},KeyZ:{keyId:"KeyZ",eng:{value:"z",alt:"Z"},rus:{value:"я",alt:"Я"}},KeyX:{keyId:"KeyX",eng:{value:"x",alt:"X"},rus:{value:"ч",alt:"Ч"}},KeyC:{keyId:"KeyC",eng:{value:"c",alt:"C"},rus:{value:"с",alt:"С"}},KeyV:{keyId:"KeyV",eng:{value:"v",alt:"V"},rus:{value:"м",alt:"М"}},KeyB:{keyId:"KeyB",eng:{value:"b",alt:"B"},rus:{value:"и",alt:"И"}},KeyN:{keyId:"KeyN",eng:{value:"n",alt:"N"},rus:{value:"т",alt:"Т"}},KeyM:{keyId:"KeyM",eng:{value:"m",alt:"M"},rus:{value:"ь",alt:"Ь"}},Comma:{keyId:"Comma",eng:{value:",",alt:"<"},rus:{value:"б",alt:"Б"}},Period:{keyId:"Period",eng:{value:".",alt:">"},rus:{value:"ю",alt:"Ю"}},Slash:{keyId:"Slash",eng:{value:"/",alt:"?"},rus:{value:".",alt:","}},ShiftRight:{keyId:"ShiftRight",eng:{value:"Shift",alt:"Shift"},rus:{value:"Shift",alt:"Shift"}},ControlLeft:{keyId:"ControlLeft",eng:{value:"Ctrl",alt:"Ctrl"},rus:{value:"Ctrl",alt:"Ctrl"}},MetaLeft:{keyId:"MetaLeft",eng:{value:"Win",alt:"Win"},rus:{value:"Win",alt:"Win"}},AltLeft:{keyId:"AltLeft",eng:{value:"Alt",alt:"Alt"},rus:{value:"Alt",alt:"Alt"}},Space:{keyId:"Space",eng:{value:"",alt:""},rus:{value:"",alt:""},specialSymbol:" "},AltRight:{keyId:"AltRight",eng:{value:"Alt",alt:"Alt"},rus:{value:"Alt",alt:"Alt"}},ControlRight:{keyId:"ControlRight",eng:{value:"Ctrl",alt:"Ctrl"},rus:{value:"Ctrl",alt:"Ctrl"}},ArrowLeft:{keyId:"ArrowLeft",eng:{value:"◂",alt:"◂"},rus:{value:"◂",alt:"◂"}},ArrowUp:{keyId:"ArrowUp",eng:{value:"▴",alt:"▴"},rus:{value:"▴",alt:"▴"}},ArrowDown:{keyId:"ArrowDown",eng:{value:"▾",alt:"▾"},rus:{value:"▾",alt:"▾"}},ArrowRight:{keyId:"ArrowRight",eng:{value:"▸",alt:"▸"},rus:{value:"▸",alt:"▸"}}},a={ROW_0:[e.Backquote,e.Digit1,e.Digit2,e.Digit3,e.Digit4,e.Digit5,e.Digit6,e.Digit7,e.Digit8,e.Digit9,e.Digit0,e.Minus,e.Equal,e.Backspace],ROW_1:[e.Tab,e.KeyQ,e.KeyW,e.KeyE,e.KeyR,e.KeyT,e.KeyY,e.KeyU,e.KeyI,e.KeyO,e.KeyP,e.BracketLeft,e.BracketRight,e.Backslash,e.Delete],ROW_2:[e.CapsLock,e.KeyA,e.KeyS,e.KeyD,e.KeyF,e.KeyG,e.KeyH,e.KeyJ,e.KeyK,e.KeyL,e.Semicolon,e.Quote,e.Enter],ROW_3:[e.ShiftLeft,e.KeyZ,e.KeyX,e.KeyC,e.KeyV,e.KeyB,e.KeyN,e.KeyM,e.Comma,e.Period,e.Slash,e.ShiftRight],ROW_4:[e.ControlLeft,e.MetaLeft,e.AltLeft,e.Space,e.AltRight,e.ControlRight,e.ArrowLeft,[e.ArrowUp,e.ArrowDown],e.ArrowRight]},t=[e.Backquote,e.BracketLeft,e.BracketRight,e.Semicolon,e.Quote,e.Comma,e.Period,e.KeyQ,e.KeyW,e.KeyE,e.KeyR,e.KeyT,e.KeyY,e.KeyU,e.KeyI,e.KeyO,e.KeyP,e.KeyA,e.KeyS,e.KeyD,e.KeyF,e.KeyG,e.KeyH,e.KeyJ,e.KeyK,e.KeyL,e.KeyZ,e.KeyX,e.KeyC,e.KeyV,e.KeyB,e.KeyN,e.KeyM],l=[e.KeyQ,e.KeyW,e.KeyE,e.KeyR,e.KeyT,e.KeyY,e.KeyU,e.KeyI,e.KeyO,e.KeyP,e.KeyA,e.KeyS,e.KeyD,e.KeyF,e.KeyG,e.KeyH,e.KeyJ,e.KeyK,e.KeyL,e.KeyZ,e.KeyX,e.KeyC,e.KeyV,e.KeyB,e.KeyN,e.KeyM],s=e=>`<div class="keyboard-key key ${e.keyId}" data-key-code="${e.keyId}">\n        ${n(e)}\n        ${u(e)}\n    </div>`,n=e=>l.includes(e)?`<span class="eng language">\n        <span class="caseDown">${e.eng.value}</span>\n        <span class="shiftCaps">${e.eng.value}</span>\n        <span class="caseUp">${e.eng.alt}</span>\n        <span class="caps">${e.eng.alt}</span>\n    </span>`:`<span class="eng language">\n        <span class="caseDown">${e.eng.value}</span>\n        <span class="shiftCaps">${e.eng.alt}</span>\n        <span class="caseUp">${e.eng.alt}</span>\n        <span class="caps">${e.eng.value}</span>\n    </span>`,u=e=>t.includes(e)?`<span class="rus language">\n        <span class="caseDown">${e.rus.value}</span>\n        <span class="shiftCaps">${e.rus.value}</span>\n        <span class="caseUp">${e.rus.alt}</span>\n        <span class="caps">${e.rus.alt}</span>\n    </span>`:`<span class="rus language">\n        <span class="caseDown">${e.rus.value}</span>\n        <span class="shiftCaps">${e.rus.alt}</span>\n        <span class="caseUp">${e.rus.alt}</span>\n        <span class="caps">${e.rus.value}</span>\n    </span>`,y=(e,a)=>{switch(e){case"eng":return l.map((e=>e.keyId)).includes(a);case"rus":return t.map((e=>e.keyId)).includes(a);default:console.error("Unsupported language",e)}},r=function(e){window.localStorage.setItem("lang",e)},c=function(){return"eng"===keyboard.dataset.lang?"rus":"eng"};let i=!1,o=!1;const d=()=>{o||(o=!0,keyboard.dataset.capsLock=!0,document.querySelector(".CapsLock").classList.add("active"))},v=()=>{o&&(o=!1,keyboard.dataset.capsLock=!1,document.querySelector(".CapsLock").classList.remove("active"))},g=e=>{const a=document.getElementById("textarea");a.focus();const t=a.selectionStart,l=a.selectionEnd,s=a.value;a.value=s.slice(0,t)+e+s.slice(l),a.setSelectionRange(t+e.length,t+e.length)};document.getElementById("main").innerHTML=`\n    <div class="wrapper">\n        <textarea class="textarea" id="textarea" cols="51" rows="10" autofocus="true"></textarea>\n        ${((e="eng",t=!1)=>((e,a,t)=>`<div class="keyboard" id="keyboard" data-lang="${a}" data-caps-lock="false" data-shift="false">\n        ${Object.values(e).map(((e,a)=>((e,a)=>`<div class="keyboard-row row-${a}">\n        ${e.map((e=>Array.isArray(e)?`\n                        <div class="keyboard-group">\n                            ${e.map((e=>s(e))).join("")}\n                        </div>\n                    `:s(e))).join("")}\n    </div>`)(e,a))).join("")}\n    </div>`)(a,e))(function(){const e=window.localStorage.getItem("lang");if(["eng","rus"].includes(e))return e}())}\n        <div>\n            <p>Keyboard created in Windows operating system</p>\n            <p>Key combination to switch language [CTRL] + [ALT]</p>\n        </div>\n    </div>\n`,(()=>{const a=document.getElementById("keyboard"),t=t=>{const{lang:l,letterCase:s}=a.dataset,{code:n}=t,u=t.shiftKey||i;a.dataset.shift=u;const k=e[n];switch(n){case e.Backspace.keyId:(()=>{const e=document.getElementById("textarea"),a=e.selectionStart,t=e.selectionEnd,l=e.value;if(a===t){const s=a-1<0?0:a-1;e.value=l.slice(0,s)+l.slice(t),e.setSelectionRange(s,s)}else e.value=l.slice(0,a)+l.slice(t),e.setSelectionRange(a,a)})();break;case e.Delete.keyId:(()=>{const e=document.getElementById("textarea"),a=e.selectionStart,t=e.selectionEnd,l=e.value;a===t?(e.value=l.slice(0,a)+l.slice(t+1),e.setSelectionRange(a,a)):(e.value=l.slice(0,a)+l.slice(t),e.setSelectionRange(a,a))})();break;case e.CapsLock.keyId:if(t.repeat)return;o?v():d();break;case e.Space.keyId:case e.Tab.keyId:case e.Enter.keyId:g(k.specialSymbol);break;case e.ShiftLeft.keyId:case e.ShiftRight.keyId:case e.MetaLeft.keyId:break;case e.ControlLeft.keyId:case e.ControlRight.keyId:case e.AltLeft.keyId:case e.AltRight.keyId:(e=>{e.repeat||e.ctrlKey&&e.altKey&&(()=>{const e=document.getElementById("keyboard"),a=c();switch(a){case"EN":case"ENG":case"en":case"eng":e.dataset.lang="eng",r("eng");break;case"RU":case"RUS":case"ru":case"rus":e.dataset.lang="rus",r("rus");break;default:console.error("Unsupported language",a)}})()})(t);break;default:if(!k)return;o||u||g(k[l].value),!o&&u&&g(k[l].alt),o&&!u&&g(y(l,t.code)?k[l].alt:k[l].value),o&&u&&g(y(l,t.code)?k[l].value:k[l].alt)}};let l;document.addEventListener("keyup",(t=>{t.stopPropagation(),t.preventDefault();const l=t.shiftKey||i;a.dataset.shift=!0===l,t.code!==e.CapsLock.keyId&&document.querySelector(`.${t.code}`)&&document.querySelector(`.${t.code}`).classList.remove("active")})),document.addEventListener("keydown",(a=>{a.stopPropagation(),a.preventDefault(),t(a),a.repeat||a.code!==e.CapsLock.keyId&&document.querySelector(`.${a.code}`)&&document.querySelector(`.${a.code}`).classList.add("active")})),document.addEventListener("mousedown",(function(e){const a=e.path.find((e=>e.classList&&e.classList.contains("key")));a&&(e.stopImmediatePropagation(),e.preventDefault(),l=a,i=["ShiftRight","ShiftLeft"].includes(l.dataset.keyCode),document.dispatchEvent(new KeyboardEvent("keydown",{code:l.dataset.keyCode,shiftKey:e.shiftKey})))})),document.addEventListener("mouseup",(function(e){l&&(e.stopImmediatePropagation(),e.preventDefault(),i=!["ShiftRight","ShiftLeft"].includes(l.dataset.keyCode)&&i,document.dispatchEvent(new KeyboardEvent("keyup",{code:l.dataset.keyCode})))}))})()})();